<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="${ctx_path}/css/styles.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="${ctx_path}/js/jquery.js"></script>
<script type="text/javascript" src="${ctx_path}/js/kindeditor/kindeditor.js"></script>

             <!--[if lte IE 6]>
<script type="text/javascript" src="js/DD_belatedPNG_0.0.8a.js"></script>
    <script type="text/javascript">
        DD_belatedPNG.fix('div, ul, img, li , a, a:hover,h3,.caption, p');
    </script>
<![endif]--> 

<script type="text/javascript">

function load()
{
	//申报状态是否已结束  如果结束 不能提交操作
	//  var StatusSb='${prize.StatusSb!}';
	 // if(StatusSb=='0')  //结束  隐藏申报按钮
	 // {
	//	 $(document.getElementById("add")).hide();
	//  }
	  var status='${project.Status!}'; //等于0未提交 3形式审查未审核通过的项目 才能操作 
	  if(status !='0' && status!='3')
	  {
		  $(document.getElementById("add")).hide();
	  }
}
</script>

<title>无标题文档</title>
</head>

<body onload="load()">
<#include "/common/_header.html"/>
<@header username=user.Username detailUrl="${ctx_path}/company/detail"/>

<div class="container_12">
    
	<#include "/project/_step_topmenu.html"/>
    
    <div class="clearfix">&nbsp;</div>
    
    <form action="${ctx_path}/project/apply" method="post" onSubmit="return check()">
            
         <input type="hidden" name="step" value='6'/> 
         <input type="hidden" name="id" value='${id}' />
		     
		      <h5><b>立项背景（不超过800个汉字）</b></h5>
		      <textarea id="content7" name="Content" style="width:1010px;height:400px;visibility:hidden;">${p.Content!}</textarea>
          <div>您当前输入了<span  id="ts1">0</span>个字 ,<span  id="ts2"></span></div>
          
          <div class="clearfix">&nbsp;</div>
		      <h5><b>详细科学技术内容</b></h5>
		      <textarea id="content4" name="Content4" style="width:1010px;height:400px;visibility:hidden;">${p.Content4!}</textarea>
          
           <div class="clearfix">&nbsp;</div>
		      <h5><b>发现/发明及创新点（不超过400个汉字）</b></h5>
		      <textarea id="content8" name="Content1" style="width:1010px;height:400px;visibility:hidden;">${p.Content1!}</textarea>
          <div>您当前输入了<span  id="ts3">0</span>个字 ,<span  id="ts4"></span></div>
          
          <!-- <div class="clearfix">&nbsp;</div>
		      <h5><b>保密要点（不超过100个汉字）</b></h5>
		      <textarea id="content9" name="Content2" style="width:1010px;height:400px;visibility:hidden;">${p.Content2!}</textarea>
          <div>您当前输入了<span  id="ts5">0</span>个字 ,<span  id="ts6"></span></div> -->
          <div class="clearfix">&nbsp;</div>
		      <h5><b>与当前国内外同类研究、同类技术的综合比较（不超过800个汉字）</b></h5>
		      <textarea id="content10" name="Content3" style="width:1010px;height:400px;visibility:hidden;">${p.Content3!}</textarea>
          <div>您当前输入了<span  id="ts7">0</span>个字 ,<span  id="ts8"></span></div>
         
     <div class="anniu"><input type="submit" id="add" class="register"  value="保存" >
     <a href="javascript:history.go(-1)" class="register" title="返回" >返回</a>
     <!-- <a href="" class="register" title="导出" >导出</a> --></div>
</form>
</div>
<script type="text/javascript">
    var isSub1 = true;
    var isSub2 = true;
    var isSub3 = true;
    var isSub4 = true;
	//加载富文本 
	KindEditor.ready(function(KE) {
		//项目立项 
		var editor = KE.create('textarea[name="Content"]', 
		    {
			uploadJson : '${ctx_path}/js/kindeditor/jsp/upload_json.jsp',
			urlType:'domain',
			allowImageRemote : false,
			afterChange : function(){
			  $('#ts1').html(this.count('text'));  //验证输入字数  字数统计包含纯文本、IMG、EMBED，不包含换行符，IMG和EMBED算一个文字
		      //限制字数
		      var limitNum = 800;  //设定限制字数
		      var pattern = '还可以输入' + limitNum + '字'; 
		      $('#ts2').html(pattern); //输入显示
		      if(this.count('text') > limitNum) {
		           pattern = ('字数超过限制，请适当删除部分内容');
		           isSub1 = false;
			       //超过字数限制自动截取
			    /*    var strValue = editor.text();
			       strValue = strValue.substring(0,limitNum);
			       editor.text(strValue);  */     
		       } else {
			       //计算剩余字数
			       var result = limitNum - this.count('text'); 
			       pattern = '还可以输入' +  result + '字'; 
			       isSub1 = true;
		       }
		       $('#ts2').html(pattern); //输入显示
			},
			afterBlur: function () { 
				this.sync();
			}
			
		});
		//详细科学技术内容
		var editor1 = KE.create('textarea[name="Content4"]', 
			{
				uploadJson : '${ctx_path}/js/kindeditor/jsp/upload_json.jsp',
				urlType:'domain',
				allowImageRemote : false,
				afterChange : function(){				 
				},
				afterBlur: function () { 
					this.sync();
				}
				
			});
		//发现/发明及创新点
		var editor1 = KE.create('textarea[name="Content1"]', 
			{
				uploadJson : '${ctx_path}/js/kindeditor/jsp/upload_json.jsp',
				urlType:'domain',
				allowImageRemote : false,
				afterChange : function(){
				  $('#ts3').html(this.count('text'));  //验证输入字数  字数统计包含纯文本、IMG、EMBED，不包含换行符，IMG和EMBED算一个文字
			      //限制字数
			      var limitNum = 400;  //设定限制字数
			      var pattern = '还可以输入' + limitNum + '字'; 
			      $('#ts4').html(pattern); //输入显示
			      if(this.count('text') > limitNum) {
			           pattern = ('字数超过限制，请适当删除部分内容');
				      /*  //超过字数限制自动截取
				       var strValue = editor1.text();
				       strValue = strValue.substring(0,limitNum);
				       editor1.text(strValue); */    
			           isSub2 = false;
			       } else {
				       //计算剩余字数
				       var result = limitNum - this.count('text'); 
				       pattern = '还可以输入' +  result + '字'; 
				       isSub2 = true;
			       }
			       $('#ts4').html(pattern); //输入显示
				},
				afterBlur: function () { 
					this.sync();
				}
				
			});
		
	/* 	//保密要点
		var editor2 = KE.create('textarea[name="Content2"]', 
			{
				uploadJson : '${ctx_path}/js/kindeditor/jsp/upload_json.jsp',
				urlType:'domain',
				allowImageRemote : false,
				afterChange : function(){
				  $('#ts5').html(this.count('text'));  //验证输入字数  字数统计包含纯文本、IMG、EMBED，不包含换行符，IMG和EMBED算一个文字
			      //限制字数
			      var limitNum = 100;  //设定限制字数
			      var pattern = '还可以输入' + limitNum + '字'; 
			      $('#ts6').html(pattern); //输入显示
			      if(this.count('text') > limitNum) {
			           pattern = ('字数超过限制，请适当删除部分内容');
				       //超过字数限制自动截取
				       // var strValue = editor2.text();
				       //strValue = strValue.substring(0,limitNum);
				       //editor2.text(strValue); 
			           //isSub3 = false;
				       
			       } else {
				       //计算剩余字数
				       var result = limitNum - this.count('text'); 
				       pattern = '还可以输入' +  result + '字'; 
				       isSub3 = true;
			       }
			       $('#ts6').html(pattern); //输入显示
				},
				afterBlur: function () { 
					this.sync();
				}
				
			}); */
		
		//与当前国内外同类研究、同类技术的综合比较
		var editor3 = KE.create('textarea[name="Content3"]', 
			{
				uploadJson : '${ctx_path}/js/kindeditor/jsp/upload_json.jsp',
				urlType:'domain',
				allowImageRemote : false,
				afterChange : function(){
				  $('#ts7').html(this.count('text'));  //验证输入字数  字数统计包含纯文本、IMG、EMBED，不包含换行符，IMG和EMBED算一个文字
			      //限制字数
			      var limitNum = 800;  //设定限制字数
			      var pattern = '还可以输入' + limitNum + '字'; 
			      $('#ts8').html(pattern); //输入显示
			      if(this.count('text') > limitNum) {
			           pattern = ('字数超过限制，请适当删除部分内容');
				       //超过字数限制自动截取
				      /*  var strValue = editor3.text();
				       strValue = strValue.substring(0,limitNum);
				       editor3.text(strValue); */   
			           isSub4 = false;
			       } else {
				       //计算剩余字数
				       var result = limitNum - this.count('text'); 
				       pattern = '还可以输入' +  result + '字'; 
				       isSub4 = true;
			       }
			       $('#ts8').html(pattern); //输入显示
				},
				afterBlur: function () { 
					this.sync();
				}
				
			});
	});

	//提交前验证 
	function check()
	{ 
		 var content7=document.getElementById("content7").value;
	     if(content7=="" || content7=="<br />")
	     {
	    	 alert("立项背景不能为空!");
	    	return false;
	     }
	     var content4=document.getElementById("content4").value;
	     if(content4=="" || content4=="<br />")
	     {
	    	 alert("详细科学技术内容不能为空!");
	    	return false;
	     }
	     
	     
	     var content8=document.getElementById("content8").value;
	     if(content8=="" || content8=="<br />")
	     {
	    	 alert("发现/发明及创新点不能为空!");
	    	return false;
	     }
	     
	   /*   var content9=document.getElementById("content9").value;
	     if(content9=="" || content9=="<br />")
	     {
	    	 alert("保密要点不能为空!");
	    	return false;
	     } */
	     
	     var content10=document.getElementById("content10").value;
	     if(content10=="" || content10=="<br />")
	     {
	    	 alert("与当前国内外同类研究、同类技术的综合比较不能为空!");
	    	return false;
	     }
	    /*  if(!isSub1||!isSub2||!isSub3||!isSub4){
 	    	 alert("字数超过限制，请适当删除部分内容");
 	    	 return false;
 	     } */
	}
    
  </script>
</body>
</html>
